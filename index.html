<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Myanmar Checkers</title>
  <style>
    body { display:flex; justify-content:center; align-items:center; height:100vh; background:#222; }
    #board { display:grid; grid-template-columns:repeat(8,60px); grid-template-rows:repeat(8,60px); }
    .cell { width:60px; height:60px; display:flex; justify-content:center; align-items:center; }
    .dark { background:#444; }
    .light { background:#ddd; }
    .piece { width:50px; height:50px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:22px; font-weight:bold; color:#fff; cursor:pointer; }
    .blue { background:#3498db; }
    .red { background:#e74c3c; }
    .king { border:3px solid gold; }
    .highlight { outline:3px solid yellow; }
    #restart { margin-top:20px; padding:10px 20px; border:none; border-radius:10px; background:#27ae60; color:#fff; font-size:18px; cursor:pointer; }
    #restart:hover { background:#2ecc71; }
    .container { text-align:center; }
  </style>
</head>
<body>
  <div class="container">
    <div id="board"></div>
    <button id="restart">ðŸ”„ Restart Game</button>
  </div>

  <script>
    const boardEl=document.getElementById("board");
    const size=8;
    let board=[], selected=null, moves=[], turn="blue";

    function init(){
      board=[];
      for(let r=0;r<size;r++){
        let row=[];
        for(let c=0;c<size;c++){
          if(r<3 && (r+c)%2===1) row.push({color:"red", king:false});
          else if(r>4 && (r+c)%2===1) row.push({color:"blue", king:false});
          else row.push(null);
        }
        board.push(row);
      }
      turn="blue";
      selected=null;
      render();
    }

    function render(){
      boardEl.innerHTML="";
      for(let r=0;r<size;r++){
        for(let c=0;c<size;c++){
          const cell=document.createElement("div");
          cell.className="cell "+(((r+c)%2)?"dark":"light");
          if(selected && moves.some(m=>m.r===r && m.c===c)) cell.classList.add("highlight");
          cell.onclick=()=>select(r,c);
          const p=board[r][c];
          if(p){
            const piece=document.createElement("div");
            piece.className="piece "+p.color+(p.king?" king":"");
            piece.innerText=p.king?"K":"";
            cell.appendChild(piece);
          }
          boardEl.appendChild(cell);
        }
      }
    }

    function inside(r,c){return r>=0&&r<size&&c>=0&&c<size;}

    function select(r,c){
      if(turn!=="blue")return;
      if(board[r][c] && board[r][c].color==="blue"){
        selected={r,c};
        moves=legalMoves(r,c);
        render();
      }else if(selected){
        const move=moves.find(m=>m.r===r && m.c===c);
        if(move)makeMove(selected.r,selected.c,move);
      }
    }

    function legalMoves(r,c){
      const p=board[r][c]; if(!p) return [];
      let moves=[];

      if(p.king){
        // âœ… King moves (any diagonal distance, all directions)
        const dirs=[[1,1],[1,-1],[-1,1],[-1,-1]];
        for(const[dr,dc] of dirs){
          let nr=r+dr,nc=c+dc;
          while(inside(nr,nc) && !board[nr][nc]){
            moves.push({r:nr,c:nc,captures:[],isCapture:false});
            nr+=dr; nc+=dc;
          }
          if(inside(nr+dr,nc+dc) && board[nr]?.[nc] && board[nr][nc].color!==p.color && !board[nr+dr][nc+dc]){
            moves.push({r:nr+dr,c:nc+dc,captures:[{r:nr,c:nc}],isCapture:true});
          }
        }
      }else{
        // âœ… Pawn moves (forward only)
        const forwardDirs = p.color==="blue" ? [[-1,-1],[-1,1]] : [[1,-1],[1,1]];

        // Normal forward step
        for(const [dr,dc] of forwardDirs){
          const nr=r+dr,nc=c+dc;
          if(inside(nr,nc) && !board[nr][nc]){
            moves.push({r:nr,c:nc,captures:[],isCapture:false});
          }
        }

        // Forward captures only
        for(const [dr,dc] of forwardDirs){
          const mr=r+dr,mc=c+dc,lr=r+2*dr,lc=c+2*dc;
          if(inside(lr,lc) && board[mr]?.[mc] && board[mr][mc].color!==p.color && !board[lr][lc]){
            moves.push({r:lr,c:lc,captures:[{r:mr,c:mc}],isCapture:true});
          }
        }
      }

      // âœ… Must capture if possible
      if(moves.some(m=>m.isCapture)){
        const maxCap=Math.max(...moves.map(m=>m.captures.length));
        return moves.filter(m=>m.isCapture && m.captures.length===maxCap);
      }
      return moves;
    }

    function makeMove(r,c,move){
      const p=board[r][c]; board[r][c]=null; board[move.r][move.c]=p;
      for(const cap of move.captures) board[cap.r][cap.c]=null;

      // Promote
      if(!p.king && (move.r===0 || move.r===size-1)) p.king=true;

      // Multi-capture
      if(move.isCapture){
        const cont=legalMoves(move.r,move.c).filter(m=>m.isCapture);
        if(cont.length){selected={r:move.r,c:move.c}; moves=cont; render(); return;}
      }

      turn = (turn==="blue")?"red":"blue";
      render();
      if(turn==="red") setTimeout(aiMove,500);
    }

    function aiMove(){
      let all=[];
      for(let r=0;r<size;r++){
        for(let c=0;c<size;c++){
          if(board[r][c]?.color==="red"){
            const mv=legalMoves(r,c);
            mv.forEach(m=>all.push({r,c,...m}));
          }
        }
      }
      if(!all.length){alert("Blue Wins!");return;}
      const move=all[Math.floor(Math.random()*all.length)];
      makeMove(move.r,move.c,move);
    }

    document.getElementById("restart").onclick=init;
    init();
  </script>
</body>
</html>
